- streaming support
- modularize the code
